(function () {
	//Created by Jason Voirin http://www.jasonvoirin.com and http://github.com/jasonvoirin
    'use strict';
    angular.module('angularFormspree', []).directive('angularFormspree', angularFormspree);
    angularFormspree.inject = ['$http'];
    function angularFormspree($http){


	  //1. Add the email you want the messages to be sent to
	  var email = "support@cartix.io";
	  //2. Add the email subject line
	  var email_subject = "Contacts to Cartix Submission";
	  //3. Add a message the user will see when the form is submitted successfully
	  var success_message = "Your message was sent! We will be in touch soon.";
	  //4. Add a message the user will see if the form receives an error and does not submit successfully
	  var error_message = "Oops. There was an error when trying to send your message.";


	  //STOP! Other than email address, email_subject and messages, no other changes are needed.

    var init = function (scope, element, attrs){
    //contact form model
		scope.contactform = {};

		//hide any contact form messages
		scope.showMessage = false;

		scope.submit = function(){

			$http({
			    url: "https://formspree.io/" + email,
			    data: {
			    	firstname: scope.contactform.firstname,
            	lastname: scope.contactform.lastname,
                    email: scope.contactform.email,
                    phone: scope.contactform.phone,
                    industry: scope.contactform.industry,
                    role: scope.contactform.role,
                    organization: scope.contactform.organization,
                    comments: scope.contactform.comments,
	                  _subject: email_subject,

			    },
			    method: 'POST',
			    headers: {
			        'Accept': 'application/json',
			        'Content-Type': 'application/x-www-form-urlencoded'
			    },
			    transformRequest: function(obj) {
			      var str = [];
			      for(var p in obj)
			      str.push(encodeURIComponent(p) + "=" + encodeURIComponent(obj[p]));
			      return str.join("&");
			    }
			}).then(function(response){
				scope.showMessage = true;
				scope.message = success_message;

			}).catch(function(error){
				scope.showMessage = true;
				scope.message = error_message;
			});
		}
      }
	  return {
		restrict: 'AE',
		scope: false,
		template: '<form ng-if="!showMessage" ng-submit="submit()">' +
					' <div class="row input">' +
          ' <div class="col-xs-6 col-md-6">'+
			      		'<input ng-model="contactform.firstname" class="form-control input-lg my_form" placeholder="first-Name" /> ' +
			      	  '</div>' +
          ' <div class="col-xs-6 col-md-6">'+
			      		'<input ng-model="contactform.lastname" class="form-control input-lg my_form" placeholder="last-Name" /> ' +
			      	  '</div>' +
                '</div>' +
        	' <div class="row input">' +
			      	  '<div class="col-xs-6 col-md-6">' +
			      		'<input ng-model="contactform.email" type="email" class="form-control input-lg my_form" placeholder="Email" /> ' +
			      	  '</div>' +
                '<div class="col-xs-6 col-md-6">' +
			      		'<input ng-model="contactform.phone"  class="form-control input-lg my_form" placeholder="phone" /> ' +
			      	  '</div>' +
                '</div>' +
          ' <div class="row input">' +
			      	  '<div class="col-xs-6 col-md-6">' +
			      		'<input ng-model="contactform.industry"  class="form-control input-lg my_form" placeholder="industry" /> ' +
			      	  '</div>' +
                '<div class="col-xs-6 col-md-6">' +
			      		'<input ng-model="contactform.role"  class="form-control input-lg my_form" placeholder="role" /> ' +
			      	  '</div>' +
                '</div>' +
                ' <input  ng-model="contactform.organization" class="form-control input-lg input my_form" placeholder="Organization"/>' +
			      	  '<div class="form-group">' +
			      		'<textarea ng-model="contactform.comments" class="form-control contact my_form" placeholder="tell us how we can help you"></textarea>' +
			      	  '</div>' +
			      	  '	<section class="button-demo">' +
			      		' <button class="ladda-button  signup-btn" data-style="expand-left" data-color="mint" type="submit" data-size="l" ng-disabled="Clientsname.$invalid">Submit</button>' +
			      	  '</section>' +
			      '</form>' +
             '<div ng-if="showMessage" class="alert alert-success"><strong>{{message}}</strong></div>',

		link: init
	  };
	};
}());
